A= ...
[ 0.94961650496175  -0.00086079266447   0.05695647856580  -0.00206512941531;
  0.00243644867557   0.97324248160060  -0.05014627397097   0.00221130704225;
  0.00003538548664   0.00072499225469   0.99953199828010  -0.00053267821142;
  0.07016414190869  -0.00232763195634  -0.06768748276232   0.98860602697171 ];

B= ...
[ 0.08390894871690  -0.00001461862848  -0.00079960496498   0.00048214761580   0.00209408900920;
  0.07052658459684  -0.00000001872741   0.00123734566619  -0.00072744090143  -0.00223686575539;
 -0.00005903324913   0.00000001232224  -0.00072727303651   0.00043455865711   0.00153266700275;
 -0.11711256225159   0.00002446893748  -0.00223443371381   0.00152963752289   0.01136052996550 ];

C= ...
[                0   0.99876617000543   0.00072504533047   0.00222099952949;
                 0   0.00072504533047   0.99956696682531  -0.00152133486438;
                 0   0.00222099952949  -0.00152133486438   0.98869654855310;
  1.00000000000000   0.00079594908648  -0.00048022213387  -0.00210894664156;
                 0   0.99876617000543   0.00072504533047   0.00222099952949;
                 0   0.00072504533047   0.99956696682531  -0.00152133486438;
                 0   0.00222099952949  -0.00152133486438   0.98869654855310 ];

D= ...
[                0                  0   0.00123382999457  -0.00072504533047  -0.00222099952949;
                 0                  0  -0.00072504533047   0.00043303317469   0.00152133486438;
                 0                  0  -0.00222099952949   0.00152133486438   0.01130345144690;
                 0                  0  -0.00079594908648   0.00048022213387   0.00210894664156;
                 0                  0   0.00123382999457  -0.00072504533047  -0.00222099952949;
                 0                  0  -0.00072504533047   0.00043303317469   0.00152133486438;
                 0                  0  -0.00222099952949   0.00152133486438   0.01130345144690 ];
			 
Sys = ss(A,B,C,D,-1);


% initial state-space
disp('R1 := Initial state-space')
R1 = SS2FWR(Sys);
Measures(R1)

% balanced realization
disp('R2 := Balanced realization')
R2 = SS2FWR(balreal(Sys));
Measures(R2)

% error_tf optimal ss realization
disp('R3 := error_tf-optimal ss realization')
S3 = SS2FWS(balreal(Sys));
%S3 = optim( S3, { 'Display', 'Iter', 'method', 'Newton' }, @error_tf)
load S3
R3=S3.R;
Measures(R3)