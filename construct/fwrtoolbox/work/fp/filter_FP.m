xn=zeros(1,4);
u=16000*ones(1,1000);
v=zeros(1,1000);

for i=1:1000
    T0=(15729*xn(1)+(8386*u(i))/2^15)/2^14;
    T1=(15729*xn(2))/2^14;
    T2=(15729*xn(3))/2^14;
    T3=(15729*xn(4))/2^14;
    
    v(i)=(T0*2^15)/2^15;
    
    xn(1)=(T0*11589 + (T1*2^13) + (xn(1)*13107)/2^2 + (u(i)*13539)/2^14)/2^13;
    xn(2)=(T0*(-9951) + (T2*2^11) + (xn(2)*16384)/2^1 + (u(i)*8741)/2^11)/2^14;
    xn(3)=(T0*10571 + (T3*2^11) + (xn(3)*9830)/2^0 + (u(i)*10654)/2^8)/2^14;
    xn(4)=((T0*(-10470))/2^1 + (xn(3)*11469)/2^0 + (u(i)*10308)/2^5)/2^14;

end